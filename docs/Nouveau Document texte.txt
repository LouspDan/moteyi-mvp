RCOMANDATION

ğŸ§­ Conseils dâ€™exploitation

Avant PR :

--mode strict en local (assure que tes chemins & checksums sont bons).

GÃ©nÃ¨re report.md et survole les â€œ(inconnu)â€ â†’ complÃ©ter matiÃ¨re/niveau/langue.

Sur PR :

CI rapide doit passer (structure ok).

Ã‰vite dâ€™ajouter de lourds PDFs au repo ; prÃ©fÃ©rer stockage externe ou Git LFS plus tard.

Nightly RAG :

VÃ©rifie eval/report.md pour le coverage et la cohÃ©rence.

Ajuste chunkers.py (taille/overlap) et retrieval.py (k, MMR, fusion BM25).

ğŸ DÃ©pannage (FAQ)

Q. La CI Ã©choue avec missing_file ?
A. VÃ©rifie que --mode ci est bien passÃ© (ou RAG_CHECK_MODE=ci). En local, utilise --mode strict.

Q. pgvector â€œconnection refused / auth failedâ€ ?
A. VÃ©rifie PG_URL (hÃ´te, port, DB, user, pass) et que lâ€™extension vector est dispo. En prod Supabase, crÃ©e lâ€™extension.

Q. openai rate limit / quota ?
A. RÃ©duis le batch (EMBED_BATCH) et/ou programme le nightly. Ã‰vite dâ€™indexer Ã  chaque commit.

Q. eval/report.md vide ?
A. Assure-toi que eval/run_eval.py existe, et quâ€™il Ã©crit le fichier mÃªme en cas dâ€™Ã©chec (fallback dÃ©jÃ  gÃ©rÃ©).

ğŸ§± Branch protection (recommandÃ©)

Exiger CI â€” Moteyi MVP âœ… pour merge vers main.

Laisser RAG Nightly en informatif (manual/cron).

ğŸ”— RÃ©fÃ©rences internes

rag/export_jsonl.py â€” export chunkÃ© depuis le catalogue (PDF â†’ JSONL)

rag/index_pgvector.py â€” indexation embeddings dans Postgres/pgvector

rag/retrieval.py â€” retrieval hybride (vector + BM25 + MMR)

eval/run_eval.py â€” harness Ã©valuation simple (coverage, temps)